if (file.exists(result_path)){
existing_data <- data.table::fread(result_path,fill = T)[-1,]
new_data <- rbind(existing_data,new_row)
write.csv(new_data,result_path)
}else{
write.csv(new_row,result_path)
}
}
# 读取暴露数据
exposure_row_data <- data.table::fread(exposure_path,fill = T)
exposure_data <- exposure_row_data[,-c(5,6,7,11:15,19:34)]
colnames(exposure_data) <- c("rsid", "alt","ref","eaf","beta","se","pval","N",
"chr","pos")
exposure_data <- nnMR::nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
exposure_data <- nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
nn_read_exposure_data <-
function (filename, clump = FALSE, sep = " ", phenotype_col = "Phenotype",
snp_col = "SNP", beta_col = "beta", se_col = "se", eaf_col = "eaf",
effect_allele_col = "effect_allele", other_allele_col = "other_allele",
pval_col = "pval", units_col = "units", ncase_col = "ncase",
ncontrol_col = "ncontrol", samplesize_col = "samplesize",
gene_col = "gene", id_col = "id", min_pval = 1e-200, log_pval = FALSE,
chr_col = "chr", pos_col = "pos")
for (i in 1:nrow(file_list)){
file_id <- file_list[[i,1]]
cat('(',i,'/',total_num,') 当前分析：',file_id,sep='')
exposure_path <- paste0('D:\\486\\原始文件\\',file_id,'.txt.gz')
# 读取暴露数据
exposure_row_data <- data.table::fread(exposure_path,fill = T)
exposure_data <- exposure_row_data[,-c(5,6,7,11:15,19:34)]
colnames(exposure_data) <- c("rsid", "alt","ref","eaf","beta","se","pval","N",
"chr","pos")
exposure_data <- nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
# LDSC分析
res <- nnMR::nn_LDSC(exposure_data,outcome_data,an='EUR',
ld='C:\\Users\\Zz\\Desktop\\lddsc\\eur',
wld='C:\\Users\\Zz\\Desktop\\lddsc\\eur')
if (!is.list(res)){
new_row <- as.data.frame('h2.trait'=file_id,'h2.mean_chisq'=NA,
'h2.lambda_gc'=NA,'h2.intercept'=NA,'h2.intercept_se'=NA,
'h2.ratio'=NA,'h2.ratio_se'=NA,'h2.h2_observed'=NA,'h2.h2_observed_se'=NA,
'h2.h2_Z'=NA,'h2.h2_p'=NA,'rg.rg'=NA,'rg.rg_se'=NA,'rg.rg_p'=NA)
}else{
h2 <- as.data.frame(res[1])[1,]
rg <- as.data.frame(res[2])[,-2]
new_row <- merge(h2,rg,by.x = 'h2.trait',by.y = 'rg.trait1')
new_row$h2.trait <- file_id
}
if (file.exists(result_path)){
existing_data <- data.table::fread(result_path,fill = T)[-1,]
new_data <- rbind(existing_data,new_row)
write.csv(new_data,result_path)
}else{
write.csv(new_row,result_path)
}
}
cat('(',i,'/',total_num,') 当前分析：',file_id,sep='')
exposure_path <- paste0('D:\\486\\原始文件\\',file_id,'.txt.gz')
# 读取暴露数据
exposure_row_data <- data.table::fread(exposure_path,fill = T)
exposure_data <- exposure_row_data[,-c(5,6,7,11:15,19:34)]
colnames(exposure_data) <- c("rsid", "alt","ref","eaf","beta","se","pval","N",
"chr","pos")
exposure_data <- nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
exposure_data <- nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
nn_read_exposure_data <-
function (filename, clump = FALSE, sep = " ", phenotype_col = "Phenotype",
snp_col = "SNP", beta_col = "beta", se_col = "se", eaf_col = "eaf",
effect_allele_col = "effect_allele", other_allele_col = "other_allele",
pval_col = "pval", units_col = "units", ncase_col = "ncase",
ncontrol_col = "ncontrol", samplesize_col = "samplesize",
gene_col = "gene", id_col = "id", min_pval = 1e-200, log_pval = FALSE,
chr_col = "chr", pos_col = "pos")
nn_read_exposure_data <-
function (filename, clump = FALSE, sep = " ", phenotype_col = "Phenotype",
snp_col = "SNP", beta_col = "beta", se_col = "se", eaf_col = "eaf",
effect_allele_col = "effect_allele", other_allele_col = "other_allele",
pval_col = "pval", units_col = "units", ncase_col = "ncase",
ncontrol_col = "ncontrol", samplesize_col = "samplesize",
gene_col = "gene", id_col = "id", min_pval = 1e-200, log_pval = FALSE,
chr_col = "chr", pos_col = "pos")
nn_read_exposure_data <-
function (filename, clump = FALSE, sep = " ", phenotype_col = "Phenotype",
snp_col = "SNP", beta_col = "beta", se_col = "se", eaf_col = "eaf",
effect_allele_col = "effect_allele", other_allele_col = "other_allele",
pval_col = "pval", units_col = "units", ncase_col = "ncase",
ncontrol_col = "ncontrol", samplesize_col = "samplesize",
gene_col = "gene", id_col = "id", min_pval = 1e-200, log_pval = FALSE,
chr_col = "chr", pos_col = "pos")
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
library(devtools)
document()
library(nnMR)
document()
library(nnMR)
document()
?met_1400
library(nnMR)
document()
library(nnMR)
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
library(nnMR)
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
document()
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
View(dat)
ldscr::ldsc_rg
library(devtools)
use_package(ldscr)
use_package('ldscr')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
use_package('ldscr')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
ldscr::ldsc_rg
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/ieuIBS')
nn_LDSC_auto_ieu(exposure_file_list='../relocated',
outcome_path='../relocated_IBS_IEU.tsv')
install.packages("microbenchmark")
library(microbenchmark)
bench_result <- microbenchmark(
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603),
times = 1
)
#' @export
nn_LDSC_auto <- function(exposure_path,exposure_source,result_path,
outcome_path,outcome_source,outcome_case){
# setwd('C:\\Users\\Zz\\Desktop\\饮食-代谢-ibs\\finnIBS')
outcome_name <- 'Finn-IBS'
# 加载存档
if(file.exists(result_path)){
checkpoint <- as.vector(read.csv(result_path)[['h2.trait']])
}else{
checkpoint <- c()
}
# 读取结局数据
outcome_data<-data.table::fread(file = outcome_path,header = T)
if (outcome_source=='finn'){
outcome_data <- outcome_data[,-c(6,8,12:13)]
outcome_data$N <- outcome_case
colnames(outcome_data) <- c("chr", "pos","ref","alt","rsid","pval","beta","se",
"eaf","N")
}
outcome_data <- nnMR::nn_read_outcome_data(filename = outcome_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
file_list <- list.files(exposure_path)
total_num <- length(file_list)
for (i in 1:length(file_list)){
file_id <- file_list[i]
cat('(',i,'/',total_num,') 当前分析：',file_id,sep='')
if (file_id %in% checkpoint){
cat('...已分析\n')
next
}
# exposure_path <- paste0('D:\\486\\原始文件\\',file_id,'.txt.gz')
# 读取暴露数据
exposure_data <- data.table::fread(paste0(exposure_path,'/',file_id),fill = T)
if (exposure_source==1400){
dd <- readxl::read_xlsx('D:\\1400\\1400血清代谢物欧洲人群总表.xlsx')[,c(1,4)]
dd$study_ID <- paste0(dd$study_ID,'.tsv.gz')
dd$initial_sample_size <- gsub(" European", "", dd$initial_sample_size)
size <- as.numeric(dd[dd$study_ID==file_id,'initial_sample_size'])
exposure_data$N <- size
colnames(exposure_data) <- c("chr", "pos","alt","ref","eaf","beta","se","pval","rsid","N")
}else if (exposure_source==486){
exposure_data <- exposure_data[,-c(5,6,7,11:15,19:34)]
colnames(exposure_data) <- c("rsid", "alt","ref","eaf","beta","se","pval","N",
"chr","pos")
}
exposure_data <- nn_read_exposure_data(filename = exposure_data,
sep = ',',
snp_col = 'rsid',
effect_allele_col = 'alt',
other_allele_col = 'ref',
eaf_col = 'eaf',
beta_col = 'beta',
se_col = 'se',
pval_col = 'pval',
samplesize_col = 'N',
chr_col = 'chr',
pos_col = 'pos')
# LDSC分析
res <- nn_LDSC(exposure_data,outcome_data,an='EUR',
ld='C:\\Users\\Zz\\Desktop\\lddsc\\eur',
wld='C:\\Users\\Zz\\Desktop\\lddsc\\eur')
if (!is.list(res)){
new_row <- as.data.frame(list('h2.trait'=file_id,'h2.mean_chisq'=NA,
'h2.lambda_gc'=NA,'h2.intercept'=NA,'h2.intercept_se'=NA,
'h2.ratio'=NA,'h2.ratio_se'=NA,'h2.h2_observed'=NA,'h2.h2_observed_se'=NA,
'h2.h2_Z'=NA,'h2.h2_p'=NA,'rg.rg'=NA,'rg.rg_se'=NA,'rg.rg_p'=NA))
}else{
h2 <- as.data.frame(res[1])[1,]
rg <- as.data.frame(res[2])[,-2]
new_row <- merge(h2,rg,by.x = 'h2.trait',by.y = 'rg.trait1')
new_row$h2.trait <- file_id
}
if (file.exists(result_path)){
existing_data <- read.csv(result_path,header = T)[,-1]
new_data <- rbind(existing_data,new_row)
write.csv(new_data,result_path)
}else{
write.csv(new_row,result_path)
}
break
}
}
bench_result <- microbenchmark(
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603),
times = 1
)
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
bench_result <- microbenchmark(
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603),
times = 1
)
print(bench_result)
library(devtools)
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
library(profvis)
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
profvis({
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
})
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
profvis({
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
})
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
options(message = FALSE)
options(cli.num_colors = 1)
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
document()
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
cli::cli_progress_step <- function(...) {}
Sys.setenv(CLI_PROGRESS_DISABLE = TRUE)
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
setwd('C:\\Users\\Zz\\Desktop\\nnMR\\nnMR')
document()
library(nnMR)
setwd('C:\\Users\\Zz\\Desktop\\gastroduodenal')
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
nn_LDSC_auto(exposure_path='D:\\1400\\原文件\\3',exposure_source=1400,result_path='LDSC3.csv',
outcome_path='finngen_R9_K11_GASTRODUOULC.gz',outcome_source='finn',outcome_case=329603)
library(nnMR)
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/15个MR_LDSC_PRESSO')
# relocated
nn_LDSC_auto(exposure_path='./relocated',exposure_source='rewrite',result_path='LDSC_relocated.csv',
outcome_path='C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv',outcome_source='ieu',outcome_case=NA)
# relocated
nn_LDSC_auto(exposure_path='./relocated',exposure_source='rewrite',result_path='LDSC_relocated.csv',
outcome_path='C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv',outcome_source='ieu',outcome_case=NA)
outcome_data <- fread('C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv')
library(data.table)
outcome_data <- fread('C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv')
outcome_data$N <- outcome_data$N_CASE+outcome_data$N_CONTROL
colnames(outcome_data) <- c("rsid", "pval","chr","pos","alt","ref","eaf","beta",
"se","N1","N2","N")
View(outcome_data[1:100,])
# relocated
nn_LDSC_auto(exposure_path='./relocated',exposure_source='rewrite',result_path='LDSC_relocated.csv',
outcome_path='C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv',outcome_source='ieu',outcome_case=NA)
setwd('C:/Users/Zz/Desktop/nnMR/nnMR')
library(devtools)
document()
setwd('C:/Users/Zz/Desktop/饮食-代谢-ibs/15个MR_LDSC_PRESSO')
# relocated
nn_LDSC_auto(exposure_path='./relocated',exposure_source='rewrite',result_path='LDSC_relocated.csv',
outcome_path='C:/Users/Zz/Desktop/饮食-代谢-ibs/IBS_IEU.tsv',outcome_source='ieu',outcome_case=NA)
setwd('C:/Users/Zz/Desktop/gastroduodenal')
dt1 <- read.csv('LDSC3.csv')[,-1]
View(dt1)
dt2 <- read.csv('LDSC2.csv')[,-1]
dt3 <- read.csv('LDSC1.csv')[,-1]
dt <- rbind(dt1,dt2)
dt <- rbind(dt,dt3)
View(dt)
all <- readxl::read_xlsx('D:/1400/1400血清代谢物欧洲人群总表-翻译.xlsx')
View(all)
all <- readxl::read_xlsx('D:/1400/1400血清代谢物欧洲人群总表-翻译.xlsx')[,-c(3:5)]
View(all)
setwd('C:/Users/Zz/Desktop/gastroduodenal')
dt1 <- read.csv('LDSC3.csv')[,-1]
dt2 <- read.csv('LDSC2.csv')[,-1]
dt3 <- read.csv('LDSC1.csv')[,-1]
dt <- rbind(dt1,dt2)
dt <- rbind(dt,dt3)
replace(dt$h2.trait,'.txt.gz','')
View(dt)
dx <- replace(dt$h2.trait,'.txt.gz','')
dx <- replace(dt$h2.trait,'.tsv.gz','')
dt1 <- read.csv('LDSC3.csv')[,-1]
dt2 <- read.csv('LDSC2.csv')[,-1]
dt3 <- read.csv('LDSC1.csv')[,-1]
dt <- rbind(dt1,dt2)
dt <- rbind(dt,dt3)
View(dt)
write.csv(dt,'1.csv')
