hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,F,T,F,F,F,F,F,T,F,F,F,T,F,F,T,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.7),
ticks = gpar(cex=0.7),
xlab = gpar(cex=0.7),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.7),
ticks = gpar(cex=0.7),
xlab = gpar(cex=0.7),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.7),
ticks = gpar(cex=0.7),
xlab = gpar(cex=0.7),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
data <- read_xlsx('敏感性分析后森林图(16个).xlsx')
data$`P−value` <- as.numeric(data$`P−value`)
data$`P−value` <- sprintf('%.3f',data$`P−value`)
data[1,3] <- 'P-value'
# 把OR、CI三列改为数值格式
data$or <- as.numeric(data$or)
data$or_lci95 <- as.numeric(data$or_lci95)
data$or_uci95 <- as.numeric(data$or_uci95)
data$`OR (95% CI)` <- paste0(sprintf("%.3f", data$or),' (',sprintf("%.3f", data$or_lci95),'-',sprintf("%.3f", data$or_uci95),')')
data[1,9] <- 'OR (95% CI)'
data <- data %>%
mutate(across(everything(), ~ifelse(. == "NA (NA-NA)", NA, .))) %>%
mutate(across(everything(), ~ifelse(. == "NA", NA, .)))
pdf("my_forestplot.pdf", family = "Times",width = 15,height = 8)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
dev.off()
dev.off()
dev.off()
pdf("my_forestplot.pdf", family = "Times",width = 15,height = 8)
# 绘图
forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
dev.off()
dev.off()
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
pdf("敏感性后森林图(16个).pdf", family = "Times",width = 15,height = 8)
# 绘图
print(plot)
dev.off()
color_vector <- ifelse(data$or > 1, "red", "royalblue")
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
plot
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = color_vector,summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
plot
color_vector <- ifelse(data$or > 1, "red", "royalblue")
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = color_vector,summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
plot
color_vector <-
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = ifelse(data$or > 1, "red", "royalblue"),summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
plot
plot <- forestplot(labeltext=as.matrix(data[,c(1:3,9)]), # 取要的数据
mean=data$or,  # OR
lower=data$or_lci95, # CI
upper=data$or_uci95, # CI
is.summary=c(T,T,F,F,T,F,F,F,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F), # 加粗的行数
# 图形位置
graph.pos=4,
# 标题
#title='Diabetic kidney disease',
# 字的大小
txt_gp=fpTxtGp(label = gpar(cex=0.8),
ticks = gpar(cex=0.8),
xlab = gpar(cex=0.8),
title = gpar(cex=1.2)),
# X轴刻度和坐标
xticks = c(0,0.5,1.0, 1.5,2.0,2.5,3),
xlab="OR (95% CI)",
zero=1,
# 分隔横线http://127.0.0.1:19473/graphics/plot_zoom_png?width=1739&height=917
#hrzl_lines = gpar(col = "#444444"),
hrzl_lines=list('2'=gpar(lwd=1,lineend='square',columns=c(1:5),col='black')),
#ci_column = 1,
# 零点竖线颜色
#col=fpColors(zero = "black"),
# 行宽
colgap=unit(7,'mm'),
# 森林图的宽度
graphwidth=unit(6, "cm"),
# 置信区间剪裁 超过的会标箭头
clip=c(0.6,1.3),
# 圆点置信区间
#fn.ci_norm = fpDrawCircleCI,
fn.ci_norm = fpDrawNormalCI,
col=fpColors(box = 'royalblue',summary = 'red',lines = '#1c61b6',zero='grey32'),
# 粗细、大小
lwd.ci=1,boxsize=0.2,
# 两端竖线
ci.vertices=TRUE,ci.vertices.height=0.1)
plot
